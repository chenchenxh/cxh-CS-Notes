## Http的特点

- 基于请求和响应
- 无状态
- 应用层
- TCP/IP

## Http和Https的区别

​	HTTP协议传输的数据都是未加密的，也就是明文的，因此使用HTTP协议传输隐私信息非常不安全，为了保证这些隐私数据能加密传输，于是网景公司设计了**SSL（Secure Sockets Layer）协议**用于对HTTP协议传输的数据进行加密，从而就诞生了HTTPS。

​	**SSL会话包含的主要参数有会话ID、对方的证书、加密套件（密钥交换算法、数据加密算法和MAC算法等）以及主密钥（master secret）**



## 状态码

| 分类 | 分类描述                                       |
| :--- | :--------------------------------------------- |
| 1**  | 信息，服务器收到请求，需要请求者继续执行操作   |
| 2**  | 成功，操作被成功接收并处理                     |
| 3**  | 重定向，需要进一步的操作以完成请求             |
| 4**  | 客户端错误，请求包含语法错误或无法完成请求     |
| 5**  | 服务器错误，服务器在处理请求的过程中发生了错误 |

- 200 - 请求成功
- 301 - 资源（网页等）被永久转移到其它URL
- 404 - 请求的资源（网页等）不存在
- 500 - 内部服务器错误

## http 1.0 / 1.1 / 2.0的区别

### 1. http 1.0

- 链接无法复用，即不支持持久链接
- 线头阻塞（Head of Line (HOL) Blocking）

### 2. http1.1
- 支持持久链接（在request和response中的header中的connection是close或者Keep-Alive进行控制）
- 支持http管道
- 使用多个TCP链接

### http2.0
- 支持多路复用（1.*版本对同一域名的请求有数量限制）
- 将通信的基本单位缩小为帧
- 首部压缩
- 服务端推送
- 请求优先级

## 请求过程

1. DNS
2. TCP三次握手
3. 请求响应（POST分为头部和请求体）

![img](https://pic1.zhimg.com/80/v2-4a9996d1f96058dc50a49caa8ddb5b90_720w.jpg)

## HTTPS

对称加密：DES，AES

非对称加密：RSA

[SSL/TLS原理，图画解析](https://zhuanlan.zhihu.com/p/36981565)

https很好的解决了http的三个缺点（被监听、被篡改、被伪装）

总结：

在现代，A和B之间要进行安全，省心的网络通信，需要经过以下几个步骤

- 通过CA体系交换public key
- 通过非对称加密算法，交换用于对称加密的密钥
- 通过对称加密算法，加密正常的网络通信

这基本就是SSL/TLS的工作过程了。

![这里写图片描述](https://imgconvert.csdnimg.cn/aHR0cDovL2ltZy5ibG9nLmNzZG4ubmV0LzIwMTYwODEyMjEwODAyNTcz?x-oss-process=image/format,png)

## HTTP的线头阻塞问题

HTTP/2 并没有解决 TCP 的队首阻塞问题，它仅仅是通过**多路复用**解决了以前 HTTP1.1 **管线化**请求时的队首阻塞。

比如 HTTP/1.1 时代建立一个 TCP 连接，三个请求组成一个队列发出去，服务器接收到这个队列之后会依次响应，一旦前面的请求阻塞，后面的请求就会无法响应。

HTTP/2 是通过**分帧**并且给每个帧打上**流**的 ID 去避免依次响应的问题，对方接收到帧之后根据 ID 拼接出流，这样就可以做到乱序响应从而避免请求时的队首阻塞问题。但是 TCP 层面的队首阻塞是 HTTP/2 无法解决的（HTTP 只是应用层协议，TCP 是传输层协议），TCP 的阻塞问题是因为传输阶段可能会丢包，一旦丢包就会等待重新发包，阻塞后续传输，这个问题虽然有**滑动窗口（Sliding Window）**这个方案，但是只能增强抗干扰，并没有彻底解决。



## HTTP的请求格式

当浏览器向Web服务器发出请求时，它向服务器传递了一个数据块，也就是请求信息，HTTP请求信息由3部分组成：

> 请求方法URI协议/版本
> 请求头(Request Header)
> 请求正文 

```
GET/sample.jspHTTP/1.1
Accept:image/gif.image/jpeg,*/*
Accept-Language:zh-cn
Connection:Keep-Alive
Host:localhost
User-Agent:Mozila/4.0(compatible;MSIE5.01;Window NT5.0)
Accept-Encoding:gzip,deflate
username=jinqiao&password=1234
```

HTTP应答与HTTP请求相似，HTTP响应也由3个部分构成，分别是：

> 协议状态版本代码描述
> 响应头(Response Header)
> 响应正文 

```html
HTTP/1.1 200 OK
Server:Apache Tomcat/5.0.12
Date:Mon,6Oct2003 13:23:42 GMT
Content-Length:112
<html>

<head>
<title>HTTP响应示例<title>
</head>

<body>
Hello HTTP!
</body>
</html>
```

## http连接优化

http连接的性能优化

1. 并行连接（能够同一时候和多台server建立HTTP连接）
2. 持久连接
3. 管道化连接
4. 复用的连接



## CA证书

X.509 标准规定了证书可以包含什么信息，并说明了记录信息的方法（数据格式）。除了签名外，所有 X.509 证书还包含以下数据：

> **版本**
> 识别用于该证书的 X.509 标准的版本，这可以影响证书中所能指定的信息。迄今为止，已定义的版本有三个。
> **序列号**
> 发放证书的实体有责任为证书指定序列号，以使其区别于该实体发放的其它证书。此信息用途很多。例如，如果某一证书被撤消，其序列号将放到证书撤消清单 (CRL) 中。
> **签名算法标识符**
> 用于识别 CA 签写证书时所用的算法。
> **签发人姓名**
> 签写证书的实体的 X.500 名称。它通常为一个 CA。 使用该证书意味着信任签写该证书的实体（注意：有些情况下（例如根或顶层 CA 证书），签发人会签写自己的证书）。
> **有效期**
> 每个证书均只能在一个有限的时间段内有效。该有效期以起始日期和时间及终止日期和时间表示，可以短至几秒或长至一世纪。所选有效期取决于许多因素，例如用于签写证书的私钥的使用频率及愿为证书支付的金钱等。它是在没有危及相关私钥的条件下，实体可以依赖公钥值的预计时间。
> **主体名**
> 证书可以识别其公钥的实体名。此名称使用 X.500 标准，因此在Internet中应是唯一的。它是实体的特征名 (DN)，例如，
> CN=Java Duke，OU=Java Software Division，O=Sun Microsystems Inc，C=US
> （这些指主体的通用名、组织单位、组织和国家）。
> **主体公钥信息**
> 这是被命名实体的公钥，同时包括指定该密钥所属公钥密码系统的算法标识符及所有相关的密钥参数。